# 업무에 바로 쓰는 SQL 튜닝 
__MySQL, MariaDB 기반의 쿼리 튜닝 기법에 대한 효율적인 방식 제공__

## 1.2 상용 RDBMS와의 차이점
### 1.2.1 구조적 차이 

__다중화 구축 시 차이점__

* ORACLE 
    * 통합된 스토리지 하나를 공유하는 방식 
    * 공유 스토리지를 사용하므로 어느 DB서버에 접속해서 SQL 수행해도 같은 결과 출력
    * 동일한 구문(SELECT, INSERT, DELETE, UPDATE) 처리 가능
* MySQL
    * 물리적 서버마다 독립적으로 스토리지 할당 
    * 대부분 마스터(쓰기,읽기)-슬레이브(읽기) 구조로 구축
    * 따라서 동일한 구문이 처리되지 않을 수 있고 각자 서버 마다 역할이 부여된다. 

### 1.3 MySQL, MariaDB 튜닝의 방식 
대다수의 SQL 문이 중첩 루프 조인 알고리즘으로 수행, 사용 DBMS와 달리 수행 결과
가 메모리에 적재되는 캐시 기능에 한계(데이터 변경 시 캐시 내용 삭제)가 있다.

__따라서 실행계획을 분석하고 문제점을 인지하여 튜닝을 진행해야 한다.__

## 2. SQL 튜닝 용어를 직관적으로 

### 스토리지 엔진 
InnoDB, MyISAM...등 / SQL 문을 토대로 DB에 저장된 디스크나 메모리에서 필요한 데이터를 가져오는 역할 수행

스토리지 엔진이 데이터를 저장하는 방식에 따라 각각의 스토리지 엔진을 선택하여 사용할 수 있다.

*   OLTP 환경 대다수인 만큼 주로 InnoDB 엔진을 사용 
*   대량의 쓰기 트랙잭션이 발생 -> MyISAM 엔진
*   메모리 데이터 로드하여 빠르게 읽는 효과를 내려면 Memory 엔진을 사용 

__MySQL8.0, MariaDB 10.5버전부터 InnoDB 엔진 중심__

### 주요 DB 엔진 단어 
* 파서(Parser) 
    * MySQL 엔진에 포함되는 오브젝트, SQL 문을 쪼개서 최소 단위로 분리하여 트리를 만든다. 
* 전처리기(preprocessor)
    * 파서에서 생성한 트리를 토대로 SQL에 구조적 문제가 없는지 파악 
    * SQL문에 작성된 테이블, 열, 함수, 뷰와 같은 오브젝트가 유효한지 파악
* 옵티마이저
    * DBMS의 두뇌, 테이블접근, 인덱스사용등에 대한 __실행계획__ 수립
    * 최적의 실행계획을 수립하는데 오래걸리고, 최상의 실행 계획이 아닐 가능성도 있다. 
    * 작업자의 직접적인 작업 필요 가능성 존재
* 엔진 실행기 
    * MySQL엔진과 스토리지 엔진 영역 모두에 걸치는 오브젝트
    * 옵티마이저에서 수렵한 실행계획을 참고하여 스토리지 엔진에서 데이터 가져온다. 
    * 이후 데이터를 정렬, 조인, 필터링등 추가작업이 실행되기 때문에 엔진의 부하를 줄이려면 스토리지 엔진에서 가져오는 데이터양을 줄여야한다. 



    