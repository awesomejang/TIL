# [SPRING] SPRING AOP 개념 및 사용법 

## Spring의 AOP종류 
* JDK 동적 프록시
    * 자바언어에서 제공하는 기능 
    * 인터페이스 기반으로 프록시를 생성
    * 인터페이스 기반으로 생성되기 때문에 구현체로 타입캐스팅이 안되는 문제가 있다.
* CGLIB
    * 구체 클래스 기반으로 프록시 생성 
    * 자바
    * 스프링부트 2.0 부터 CGLIB를 기본 사용하도록 변경 


## SPRING AOP의 단어
* 포인트컷(PointCut)
    * 어디에 부가 기능을 적용할지, 어디에 부가 기능을 적용하지 않을지 판단하는 필터링 
    * 주로 클래스와 메서드 이름으로 필터링 한다, 이름그대로 어떤 포인트(Point)에
       기능을 적용할지 하지 않을지 잘라서(cut)구분한다. 
* 어드바이스(Advice)
    * 프록시가 호출하는 부가 기능으로 단순히 프록시 로직이라 생각하면 된다. 
* 어드바이저(Advisor)
    * 단순하게 하나의 포인트컷과 하나의 어드바이스를 가지고 있는 것 
    * 포인트컷 + 어드바이스이다. 

포인트컷(PointCut)으로 어디에 AOP를 적용할지 지정하고 어드바이스(Advice)로 어떤 로직을 적용할지 선택한다.

<br/>

## 스프링의 빈 후처리기 
__AnnotationAwareAspectJAutoProxyCreator__ 라는 빈후처리기는 스프링 빈으로 등록된 어드바이저들을 자동으로 찾아서 프록시가 필요한 곳에 자동으로 프록시를 적용한다. 

어드바이저안에는 포인트컷과 어드바이스가 포함되어 있기때문에 어떤 스프링 빈에 프록시를 적용해야 하는지 알 수 있다. 

* 스프링 프록시 생성 작동 과정 
    * 스프링이 AP로딩 시점에 자동 프록시 생성기 호출
    * 모든 @Aspect를 조회한

## 다수의 어드바이저가 등록될 경우 
만약 "CardService"라는 클래스가 다수의 어드바이저의 대상이 된다면 CardService의 프록시는 대상만큼 생성될까? 그렇지 않다. 프록시는 하나만 생성하고 여러 어드바이스를 등록한다.

즉 다수의 어드바이저의 대상이 되도 스프링은 target마다 하나의 프록시만 생성하고 여러 어드바이스를 등록한다. 



